//devin87@qq.com
//build:2016/12/27 14:53:16
!function(t){"use strict";function e(t){var e=I("div","x-mask");Q.body.appendChild(e),F&&(e.style.height=P.getScrollHeight()+"px"),this.box=e,this.set(k(t||{},G))}function i(){return J?(J.show(),J):J=new e}function n(t,e){k(G,t,!0),e&&J&&J.reset(t)}function o(t){for(var e=[],i=t||f;i.top!=i;){var n=i.parent;e.push(n),i=n}return e}function s(t){var e=this;w(t,e),e._apis=[],e.start()}function r(t,e){return new s(function(){1!=t.nodeType?(e=t,t=e.ele):(e=e||{},e.ele=t);var i,n,o,s,r,a,c,l,u=this,d=e.range||{x:0,y:0},h=!!e.shadow,f=t.offsetWidth,v=t.offsetHeight,p=t;h&&(tt||(tt=I("div","x-drag-shadow"),Q.body.appendChild(tt)),p=tt),u.ops=e,u.doDown=function(e){o=e.clientX,s=e.clientY;var r=h?$(t).offset():$(t).position();i=r.left,n=r.top,h&&Object.forEach({left:i,top:n,width:f,height:v},function(t,e){p.style[t]=e+"px"})},u.doMove=function(t){if(B(p),c){r=t.clientX-o;var e=i+r;d&&(e<d.x?e=d.x:d.w&&e+f>d.x+d.w&&(e=d.x+d.w-f)),p.style.left=e+"px"}if(l){a=t.clientY-s;var u=n+a;d&&(u<d.y?u=d.y:d.h&&u+v>d.y+d.h&&(u=d.y+d.h-v)),p.style.top=u+"px"}},h&&(u.doUp=function(){W(p),t.style.left=t.offsetLeft+r+"px",t.style.top=t.offsetTop+a+"px"}),u.setLock=function(t,e){return c=t,l=e,u.pause(!t&&!e)},u.setRange=function(t,e,i,n){return d=x(t)?t:{x:t,y:e,w:i,h:n},u},u.setLock(e.isX!==!1,e.isY!==!1)})}function a(t){this._es=[],w(t,this)}function c(t){k(et,t,!0)}function l(t){return t=t||{},new a(function(){var n=this,o=t.width,s=t.height,a=t.maxHeight,c=t.drag!==!1,l=c&&t.center!==!1,u=t.className;n.ops=t,n.callback=t.callback;var d='<div class="x-head"><h2 class="x-title">'+(t.title||et.titleBox)+'</h2><a class="x-close" title="'+et.titleClose+'">X</a></div><div class="x-main"><div class="x-view">'+(t.html||"")+"</div></div>";F&&(d+='<iframe class="x-ie-fix" style="position: absolute;top:0;left:0;z-index:-1;" scrolling="no" frameborder="0"></iframe>');var h=I("div","x-box"+(u?" "+u:""),d);Q.body.appendChild(h),n.box=h;var f=t.zIndex||0;Z>V&&(f=Math.max(f,Z)),f&&(h.style.zIndex=f);var x=z(h),p=E(x);n.setTitle=function(t){return $(".x-title",x).html(t),n},n.setWidth=function(e){return t.width=e,M(h,e),w(t.resize,n),n},n.setHeight=function(e){return t.height=e,S(p,e-x.offsetHeight-20),n},n.setMaxHeight=function(e){t.maxHeight=e;var i=t.height;return m(i)&&i>e&&(i=e),h.scrollHeight>e&&(i=e,N(h,"x-box-auto")),m(i)&&n.setHeight(i),l&&X(h),w(t.resize,n),n},m(o)&&M(h,o),x.offsetWidth<10&&M(x,h.offsetWidth),a?n.setMaxHeight(a):m(s)&&n.setHeight(s),t.mask&&(n.mbox="new"==t.mask?new e:i());var g=t.close||"hide",k=n.getEventCallback(g);n.bind(".x-close","click",g),t.esc!==!1&&n.bind(v,"keyup",function(t){27==t.keyCode&&k()});var _=t.time;b(_)&&y(k,_),w(t.init,n,h,t),c&&(n.dr=r(h,{target:x,center:l,shadow:t.shadow,autoMask:!0,onCheck:function(t){var e=t.target;return e&&"x-close"!=e.className}})),$(".x-ie-fix",h).width(h.offsetWidth-2).height(h.offsetHeight-2)})}function u(t){t.width||(t.width=320);var e=t.width;if(t.icon||t.iconHtml){var i='<div class="fl x-ico">'+(t.iconHtml||'<img alt="" src="'+t.icon+'"/>')+'</div><div class="fl x-dialog"'+(m(e)?' style="width:'+(e-60)+'px;"':"")+">"+t.html+'</div><div class="clear"></div>';t.html=i;var n=t.init;t.resize=function(){var t=this,e=t.get(".x-view").offsetWidth-t.get(".x-ico").offsetWidth;$(".x-dialog",t.box).width(e)},t.init=function(t,e){var i=this;e.resize.call(i),w(n,i,t,e)}}else t.html='<div class="x-dialog">'+t.html+"</div>";return t.bottom&&(t.html+=t.bottom),t.close||(t.close="remove"),l(t)}function d(t,e){var i="inline-block w-button w-"+(e||"dark"),n='<div class="x-bottom"><div class="'+i+' x-submit">'+et.buttonSubmit+"</div>"+(2==t?'<div class="'+i+' x-cancel">'+et.buttonCancel+"</div>":"")+"</div>";return n}function h(t,e,i,n){return"object"==typeof i&&(n=i,i=n),n=k({},n),p(i)&&(n.callback=i),n.title||(n.title=t),n.html=e,n}var f=Q.G,v=f.document,x=Q.isObject,p=Q.isFunc,m=Q.isUNum,b=Q.isUInt,g=Q.def,w=Q.fire,y=Q.async,k=Q.extend,_=Q.makeArray,C=Q.getStyle,H=Q.setStyle,z=Q.getFirst,E=Q.getNext,M=Q.width,S=Q.height,I=Q.createEle,L=Q.removeEle,B=Q.show,W=Q.hide,D=Q.isHidden,N=Q.addClass,U=Q.setCssIfNot,X=Q.setCenter,j=Q.setInputError,T=Q.setInputDefault,A=Q.clearSelection,O=Q.query,R=Q.factory,Y=Q.ie,F=7>Y,P=Q.view,q=Q.event,G={color:"#999",opacity:.3};R(e).extend({opacity:function(t){return this.set({opacity:t})},set:function(e){var i=this.box;return Object.forEach(e,function(e,n){n!==t&&H(i,"color"!=e?e:"backgroundColor",n)}),this},show:function(){return this.removed&&(Q.body.appendChild(this.box),this.removed=!1),B(this.box),this},hide:function(){return W(this.box),this},remove:function(){return L(this.box),this.removed=!0,this}});var J,K,V=1e3,Z=V;R(s).extend({start:function(){var t=this,i=t.ops,n=i.scope||f,s=n.document,r=i.ele,a=i.target||r,c=i.autoIndex!==!1,l=!!i.autoMask,u=i.autoCss!==!1,d=i.autoCursor!==!1,h=1==r.nodeType?+C(r,"z-index"):0,v=t.doDown,x=t.doMove,m=t.doUp,b=i.onCheck,g=i.onDown,Q=i.onMove,k=i.onUp,_=o(n),H=!!r.setCapture,z=!H&&_.length>0;h>=Z&&(Z=h+1),u&&U(r,"position","absolute"),u&&d&&U(a,"cursor","move"),i.center&&(X(r),t._api_resize=q.add(n,"resize",function(){X(r)}));var E=function(i){if(!p(b)||b.call(t,i)!==!1){if(c){var o=+C(r,"z-index")||0;Z>o&&(Z++,r.style.zIndex=Z)}t._unbind(),H?(r.setCapture(),t._bind(r,"losecapture",S)):t._bind(n,"blur",S),t._bind(s,{mousemove:M,mouseup:S}),z&&t._bind(_,"mouseup",S),l&&(K||(K=new e({color:null,opacity:null,zIndex:999999})),F&&K.set({height:P.getScrollHeight()})),y(A,20),w(v,t,i),w(g,t,i)}},M=function(e){t._pause||(w(x,t,e),w(Q,t,e))},S=function(e){t._unbind(),H&&r.releaseCapture(),l&&K&&(K.remove(),K=null),A(),w(m,t,e),w(k,t,e)};return t._up=S,t._api=q.add(a,"mousedown",E),t},_bind:function(){this._apis.push(q.add.apply(q,arguments))},_unbind:function(){var t=this._apis;t.length>0&&(t.forEach(function(t){t.off()}),this._apis=[])},pause:function(t){var e=this;return e._pause=t,e._up&&e._up(),e},stop:function(){var t=this,e=t._api;return t._unbind(),e&&(e.off(),t._api=null),t},destroy:function(){var t=this,e=t._api_resize;return t.stop(),e&&(e.off(),t._api_resize=null),t}});var tt;$.fn.extend({drag:function(t){return this.each(function(e,i){r(i,t)})}}),R(a).extend({find:function(t,e){return"string"==typeof t?O(t,e||this.box):_(t)},get:function(t,e){return this.find(t,e)[0]},fire:function(){return w(this.callback,this,this.data),this},getEventCallback:function(t,e){var i=this;return"hide"==t?function(){i.data=e,i.hide()}:"remove"==t?function(){i.data=e,i.remove()}:t},bind:function(t,e,i,n){var o=this;return o._es.push(q.add(o.find(t),e,o.getEventCallback(i,n))),o},on:function(t,e,i,n){var o=this;return o._es.push(q.add(o.box,t,e,o.getEventCallback(i,n))),o},show:function(){var t=this;return t.onShow&&t.onShow(),B(t.box),t.mbox&&t.mbox.show(),t},hide:function(){var t=this;return W(t.box),t.mbox&&t.mbox.hide(),t.onHide&&t.onHide(),t.fire()},toggle:function(){return D(this.box)?this.show():this.hide()},remove:function(){var t=this;if(t.box)return L(t.box),t.mbox&&t.mbox.remove(),t.dr&&t.dr.destroy(),t._es.forEach(function(t){t.off()}),t.box=t.mbox=t.dr=null,t.onRemove&&t.onRemove(),t.fire()}}),a.alias("remove","destroy");var et={titleBox:"弹出框",titleAlert:"提示信息",titleConfirm:"确认信息",titlePrompt:"输入信息",titleClose:"点击关闭",titleLoading:"加载数据",buttonSubmit:"确定",buttonCancel:"取消",textLoading:"正在加载数据,请稍后…"},it={createDialogBox:u,alert:function(t,e,i){return i=h(et.titleAlert,t,e,i),i.iconHtml='<div class="ico x-alert"></div>',u(i)},confirm:function(t,e,i){i=h(et.titleConfirm,t,e,i),i.bottom||(i.bottom=d(2)),i.mask=i.mask!==!1;var n=u(i);return n.bind(".x-submit","click","remove",!0).bind(".x-cancel","click","remove",!1)},prompt:function(e,i,n){n=h(et.titlePrompt,t,i,n);var o='<div class="x-text">'+e+'</div><div class="x-input"><input type="'+(n.pwd?"password":"text")+'" /></div>';n.html=o,n.bottom||(n.bottom=d(2));var s=u(n),r=s.get(".x-input>input");r.focus(),r.value=g(n.value,"");var a=function(){var t=w(i,r,r.value);t!==!1?s.remove():j(r)};return s.bind(r,"keyup",function(t){13==t.keyCode?a():T(this)}),s.bind(".x-submit","click",a).bind(".x-cancel","click","remove")},bottom:d,showLoading:function(t){return t=k({},t),t.title||(t.title=et.titleLoading),t.html||(t.html=et.textLoading),t.iconHtml='<div class="ico x-loading"></div>',u(t)}};k(Q,it),k(Q,{getMaskBox:i,maskSetup:n,setDrag:r,setBoxLang:c,MaskBox:e,DragX:s,Box:a,WinBox:l})}();