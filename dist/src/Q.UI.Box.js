//devin87@qq.com
//build:2022/04/14 11:13:42
!function(r){"use strict";var i,k=Q.G,f=k.document,m=Q.isObject,_=Q.isFunc,x=Q.isUNum,v=Q.isUInt,p=Q.def,C=Q.fire,H=Q.async,o=Q.extend,n=Q.makeArray,z=Q.getStyle,s=Q.setStyle,b=Q.getFirst,g=Q.getNext,w=Q.width,y=Q.height,E=Q.createEle,e=Q.removeEle,L=Q.show,M=Q.hide,a=Q.isHidden,S=Q.addClass,I=Q.setCssIfNot,B=Q.setCenter,c=Q.setInputError,u=Q.setInputDefault,W=Q.clearSelection,h=Q.query,t=Q.factory,D=Q.ie<7,N=Q.view,l=Q.Listener,U=Q.event,d={color:"#999",opacity:.3};function X(t){var e=E("div","x-mask");Q.body.appendChild(e),D&&(e.style.height=N.getScrollHeight()+"px"),this.box=e,this.set(o(t||{},d)),this.count=a(e)?0:1}function j(){return i?(i.show(),i):i=new X}t(X).extend({opacity:function(t){return this.set({opacity:t})},set:function(t){var i=this.box;return Object.forEach(t,function(t,e){e!==r&&s(i,"color"!=t?t:"backgroundColor",e)}),this},show:function(){return this.removed&&(Q.body.appendChild(this.box),this.removed=!1),L(this.box),this.count++,this},hide:function(){return 0<this.count&&this.count--,this.count<=0&&M(this.box),this},remove:function(){return e(this.box),this.removed=!0,this.count=0,this}});var T,A,O=1e3,R=O;function Y(t){C(t,this),this._apis=[],this.start()}function q(v,t){return new Y(function(){1!=v.nodeType?v=(t=v).ele:(t=t||{}).ele=v;var i,n,o,s,r,a,c,u,h=this,l=t.range||{x:0,y:0},e=!!t.shadow,d=v.offsetWidth,f=v.offsetHeight,x=v;e&&(A||(A=E("div","x-drag-shadow"),Q.body.appendChild(A)),x=A),h.ops=t,h.doDown=function(t){o=t.clientX,s=t.clientY;t=e?$(v).offset():$(v).position();i=t.left,n=t.top,e&&Object.forEach({left:i,top:n,width:d,height:f},function(t,e){x.style[t]=e+"px"})},h.doMove=function(t){var e;L(x),c&&(r=t.clientX-o,e=i+r,l&&(e<l.x?e=l.x:l.w&&e+d>l.x+l.w&&(e=l.x+l.w-d)),x.style.left=e+"px"),u&&(a=t.clientY-s,t=n+a,l&&(t<l.y?t=l.y:l.h&&t+f>l.y+l.h&&(t=l.y+l.h-f)),x.style.top=t+"px")},e&&(h.doUp=function(){M(x),v.style.left=v.offsetLeft+r+"px",v.style.top=v.offsetTop+a+"px"}),h.setLock=function(t,e){return c=t,u=e,h.pause(!t&&!e)},h.setRange=function(t,e,i,n){return l=m(t)?t:{x:t,y:e,w:i,h:n},h},h.setLock(!1!==t.isX,!1!==t.isY)})}t(Y).extend({start:function(){var e=this,t=e.ops,i=t.scope||k,n=i.document,o=t.ele,s=t.target||o,r=!1!==t.autoIndex,a=!!t.autoMask,c=!1!==t.autoCss,u=!1!==t.autoCursor,h=1==o.nodeType?+z(o,"z-index"):0,l=e.doDown,d=e.doMove,f=e.doUp,x=t.onCheck,v=t.onDown,m=t.onMove,p=t.onUp,b=function(t){for(var e=[],i=t||k;i.top!=i;){var n=i.parent;e.push(n),i=n}return e}(i),g=!!o.setCapture,w=!g&&0<b.length;R<=h&&(R=1+h),c&&I(o,"position","absolute"),c&&u&&I(s,"cursor","move"),t.center&&(B(o),e._api_resize=U.add(i,"resize",function(){B(o)}));var y=function(t){e._pause||(C(d,e,t),C(m,e,t))},Q=function(t){e._unbind(),g&&o.releaseCapture(),a&&T&&(T.remove(),T=null),W(),C(f,e,t),C(p,e,t)};return e._up=Q,e._api=U.add(s,"mousedown",function(t){_(x)&&!1===x.call(e,t)||(r&&(+z(o,"z-index")||0)<R&&(R++,o.style.zIndex=R),e._unbind(),g?(o.setCapture(),e._bind(o,"losecapture",Q)):e._bind(i,"blur",Q),e._bind(n,{mousemove:y,mouseup:Q}),w&&e._bind(b,"mouseup",Q),a&&(T=T||new X({color:null,opacity:null,zIndex:999999}),D&&T.set({height:N.getScrollHeight()})),H(W,20),C(l,e,t),C(v,e,t))}),e},_bind:function(){this._apis.push(U.add.apply(U,arguments))},_unbind:function(){var t=this._apis;0<t.length&&(t.forEach(function(t){t.off()}),this._apis=[])},pause:function(t){return this._pause=t,this._up&&this._up(),this},stop:function(){var t=this._api;return this._unbind(),t&&(t.off(),this._api=null),this},destroy:function(){var t=this._api_resize;return this.stop(),t&&(t.off(),this._api_resize=null),this}}),$.fn.extend({drag:function(i){return this.each(function(t,e){q(e,i)})}});var F=new l(["init","show","hide","remove"]);function P(t){this._es=[],C(t,this),F.trigger("init",[this])}t(P).extend({find:function(t,e){return"string"==typeof t?h(t,e||this.box):n(t)},$:function(t,e){return $(this.find(t,e))},get:function(t,e){return this.find(t,e)[0]},fire:function(){return C(this.callback,this,this.data),this},getEventCallback:function(t,e){var i=this;return"hide"==t?function(){i.data=e,i.hide()}:"remove"==t?function(){i.data=e,i.remove()}:t},bind:function(t,e,i,n){return this._es.push(U.add(this.find(t),e,this.getEventCallback(i,n))),this},on:function(t,e,i,n){return this._es.push(U.add(this.box,t,e,this.getEventCallback(i,n))),this},show:function(){var t=this;return t.onShow&&t.onShow(),L(t.box),t.mbox&&t.mbox.show(),F.trigger("show",[t]),t},hide:function(){var t=this;return M(t.box),t.mbox&&t.mbox.hide(),t.onHide&&t.onHide(),F.trigger("hide",[t]),t.fire()},toggle:function(){return a(this.box)?this.show():this.hide()},remove:function(){var t=this;if(t.box)return e(t.box),t.mbox&&t.mbox.hide(),t.dr&&t.dr.destroy(),t._es.forEach(function(t){t.off()}),t.box=t.mbox=t.dr=null,t.onRemove&&t.onRemove(),F.trigger("remove",[t]),t.fire()}}),P.alias({$:"query",remove:"destroy"}),P.on=function(t,e){return F.add(t,e),P};var G={titleBox:"弹出框",titleAlert:"提示信息",titleConfirm:"确认信息",titlePrompt:"输入信息",titleClose:"点击关闭",titleLoading:"加载数据",buttonSubmit:"确定",buttonCancel:"取消",textLoading:"正在加载数据,请稍后…"};function J(d){return d=d||{},new P(function(){var i=this,t=d.width,e=d.height,n=p(d.maxHeight,N.getHeight()-60),o=!1!==d.drag,s=o&&!1!==d.center,r=d.className;i.ops=d,i.callback=d.callback;var a='<div class="x-head"><h2 class="x-title">'+(d.title||G.titleBox)+'</h2><a class="x-close" title="'+G.titleClose+'">X</a></div><div class="x-main"><div class="x-view">'+(d.html||"")+"</div></div>";D&&(a+='<iframe class="x-ie-fix" style="position: absolute;top:0;left:0;z-index:-1;" scrolling="no" frameborder="0"></iframe>');var c=E("div","x-box"+(r?" "+r:""),a);Q.body.appendChild(c),i.box=c;a=d.zIndex||0;(a=O<R?Math.max(a,R):a)&&(c.style.zIndex=a);var u=b(c),h=g(u);i.setTitle=function(t){return $(".x-title",u).html(t),i},i.setWidth=function(t){return d.width=t,w(c,t),C(d.resize,i),i},i.setHeight=function(t){return d.height=t,y(h,t-u.offsetHeight-20),i},i.setMaxHeight=function(t){d.maxHeight=t;var e=d.height;return x(e)&&t<e&&(e=t),c.scrollHeight>t&&(e=t,S(c,"x-box-auto")),x(e)&&i.setHeight(e),s&&B(c),C(d.resize,i),i},i.autoHeight=function(){var t=d.maxHeight;if(!t)return i;var e=i.get(".x-head").offsetHeight;return h.style.height=h.scrollHeight>t-e?t-e-20+"px":"auto",s&&B(c),i},x(t)&&w(c,t),u.offsetWidth<10&&w(u,c.offsetWidth),n?i.setMaxHeight(n):x(e)&&i.setHeight(e),!1!==d.mask&&(i.mbox="new"==d.mask?new X:j());var e=d.close||"hide",l=i.getEventCallback(e);i.bind(".x-close","click",e),!1!==d.esc&&i.bind(f,"keyup",function(t){27==t.keyCode&&l()});e=d.time;v(e)&&H(l,e),C(d.init,i,c,d),o&&(i.dr=q(c,{target:u,center:s,shadow:d.shadow,autoMask:!0,onCheck:function(t){t=t.target;return t&&"x-close"!=t.className}})),$(".x-ie-fix",c).width(c.offsetWidth-2).height(c.offsetHeight-2)})}function K(t){t.width||(t.width=320);var i,e=t.width;return t.icon||t.iconHtml?(e='<div class="fl x-ico">'+(t.iconHtml||'<img alt="" src="'+t.icon+'"/>')+'</div><div class="fl x-dialog"'+(x(e)?' style="width:'+(e-60)+'px;"':"")+">"+t.html+'</div><div class="clear"></div>',t.html=e,i=t.init,t.resize=function(){var t=this.get(".x-view").offsetWidth-this.get(".x-ico").offsetWidth;$(".x-dialog",this.box).width(t)},t.init=function(t,e){e.resize.call(this),C(i,this,t,e)}):t.html='<div class="x-dialog">'+t.html+"</div>",t.bottom&&(t.html+=t.bottom),t.close||(t.close="remove"),J(t)}function V(t,e){e="inline-block w-button w-"+(e||"dark");return'<div class="x-bottom"><div class="'+e+' x-submit">'+G.buttonSubmit+"</div>"+(2==t?'<div class="'+e+' x-cancel">'+G.buttonCancel+"</div>":"")+"</div>"}function Z(t,e,i,n){return"object"==typeof i&&(i=n=i),n=o({},n),_(i)&&(n.callback=i),n.title||(n.title=t),n.html=e,n}o(Q,{createDialogBox:K,alert:function(t,e,i){return(i=Z(G.titleAlert,t,e,i)).iconHtml='<div class="ico x-alert"></div>',K(i)},confirm:function(t,e,i){return(i=Z(G.titleConfirm,t,e,i)).bottom||(i.bottom=V(2)),i.mask=!1!==i.mask,K(i).bind(".x-submit","click","remove",!0).bind(".x-cancel","click","remove",!1)},prompt:function(t,e,i){i=Z(G.titlePrompt,r,e,i),e=i.callback,i.callback=r;t='<div class="x-text">'+t+'</div><div class="x-input"><input type="'+(i.pwd?"password":"text")+'" /></div>';i.html=t,i.bottom||(i.bottom=V(2));var n=K(i),o=n.get(".x-input>input");o.focus(),o.value=p(i.value,"");function s(){!1!==C(e,o,o.value)?n.remove():c(o)}return n.bind(o,"keyup",function(t){13==t.keyCode?s():u(this)}),n.bind(".x-submit","click",s).bind(".x-cancel","click","remove")},bottom:V,showLoading:function(t){return(t=o({},t)).title||(t.title=G.titleLoading),t.html||(t.html=G.textLoading),t.iconHtml='<div class="ico x-loading"></div>',K(t)}}),o(Q,{getMaskBox:j,maskSetup:function(t,e){o(d,t,!0),e&&i&&i.reset(t)},setDrag:q,setBoxLang:function(t){o(G,t,!0)},MaskBox:X,DragX:Y,Box:P,WinBox:J})}();