//devin87@qq.com
//build:2020/03/26 15:30:46
!function(o){"use strict";var c=window.document,e=Q.isFunc,r=Q.extend,f=Q.getFirst,u=Q.getNext,d=Q.getLast,h=Q.createEle,t=Q.factory,v=Q.event,p={cubic_color:"立方色",series_color:"连续色调",gray_color:"灰度等级"};function i(t,r,e){r!=o&&(t.style.left=r+"px"),e!=o&&(t.style.top=e+"px")}function a(t,r){return"#"+(r?Math.round(255*r).toString(16):"")+("00000"+t.toString(16)).slice(-6)}function n(t,r,e,o){return a(65536*t+256*r+ +e,o)}function l(t){var r=[];if("number"==typeof t&&(t=a(t)),0==t.indexOf("#")){var e=t.length;return 3!=e&&4!=e||(t="#"+t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2),4==e&&(t+=t.charAt(3)+t.charAt(3))),9==e&&(r[3]=Math.round(100*parseInt(t.substr(1,2),16)/255)/100,t="#"+t.slice(3)),7==t.length&&(r[0]=parseInt(t.substr(1,2),16),r[1]=parseInt(t.substr(3,2),16),r[2]=parseInt(t.substr(5,2),16)),r}var o=(t=t.replace(/\s+/g,"")).indexOf("(");return-1!=o&&(r=t.slice(o+1,-1).split(",")),r}function s(t){var r=l(t);return r.length<=0?t:n.apply(o,r.slice(0,3))}Q.parseColor=l,Q.toHex=s,Q.toAHex=function(t){var r=l(t);return r.length<=0?t:n.apply(o,r)},Q.toRGB=function(t){var r=l(t);return r.length<=0?t:"rgb("+r.slice(0,3).join(",")+")"},Q.toRGBA=function(t){var r=l(t);return r.length<=0?t:"rgba("+r.join(",")+")"};var b=["#000000","#333333","#666666","#999999","#cccccc","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff"];function x(t){var r=this;r.row=12,r.col=21,r.set(t).init()}t(x).extend({init:function(){var e=this,t='<div class="xp-title"><div class="xp-preview"></div><div class="xp-val"></div><div class="xp-type"><select><option value="Cube" selected="selected">'+p.cubic_color+'</option><option value="Series">'+p.series_color+'</option><option value="Gray">'+p.gray_color+'</option></select></div></div><div class="xp-table"><table>'+("<tr>"+"<td></td>".repeat(e.col)+"</tr>").repeat(e.row)+"</table></div>",r=h("div","x-picker",t),o=f(r),i=f(o),n=u(i),l=d(o),s=d(r),a=f(s);return Q.body.appendChild(r),e.box=r,e.table=a,e.boxPreview=i,e.boxValue=n,v.add(f(l),"change",function(){e["draw"+this.value+"Color"]()}),v.add(a,{mouseover:function(t){e.setPreview(this.style.backgroundColor)},click:function(t){var r=this.style.backgroundColor;e.fire(r).hide()}},"td"),v.add(r,"click",v.stop),v.add(c,"click",function(t){e.hide()}),e.drawCubeColor().hide()},set:function(t){return r(this,t,!0),this.setPreview((t||{}).color)},fire:function(t){var r=this;return e(r.callback)&&r.callback.call(r,r.isHex?s(t):t),r},setPreview:function(t){return t&&(this.boxPreview.style.backgroundColor=t,this.boxValue.innerHTML=s(t).toUpperCase()),this},fillColor:function(t,r,e){return this.table.rows[t].cells[r].style.backgroundColor=e,this},drawLeftColor:function(){for(var t=this.row,r=0;r<t;r++)this.fillColor(r,0,"#000").fillColor(r,1,b[r]).fillColor(r,2,"#000");return this},drawCubeColor:function(){var t,r=this,e=r.row,o=r.col,i=0;r.drawLeftColor();for(var n=0;n<e;n++){t=i=5<n?10027008+51*(n-6):0+51*n;for(var l=3;l<o;l++)r.fillColor(n,l,a(t)),t+=13056,(l-2)%6==0&&(t=i+=3342336)}return r},drawSeriesColor:function(){var t,r=this,e=r.row,o=r.col,i=13434879,n=1;r.drawLeftColor();for(var l=0;l<e;l++){t=i=5<l?16711935+13056*(l-6):13434879-13056*l,n=1;for(var s=3;s<o;s++)r.fillColor(l,s,a(t)),t-=51*n,(s-2)%6==0&&(t=(i-=6684672)-(0<(n*=-1)?0:255))}return r},drawGrayColor:function(){for(var t=this.row,r=this.col,e=16777215,o=0;o<t;o++)for(var i=0;i<r;i++)this.fillColor(o,i,a(e)),e<=0?e=0:e-=65793;return this},show:function(t,r){var e=this;return t==o?t=e.x:e.x=t,r==o?r=e.y:e.y=r,i(e.box,t,r),e},hide:function(){return i(this.box,-1e4,-1e4),this},isHidden:function(){var t=this.box,r=parseFloat(t.style.left),e=parseFloat(t.style.top);return r<=-t.offsetWidth||e<=-t.offsetHeight},toggle:function(t,r){return this.isHidden()?this.show(t,r):this.hide()}}),x.setLang=function(t){r(p,t,!0)},Q.ColorPicker=x}();